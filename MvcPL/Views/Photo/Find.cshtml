@model IEnumerable<MvcPL.ViewModels.PhotoViewModel>
@{
    ViewBag.Title = "Find";
    Layout = "~/Views/Shared/_PhotoLayout.cshtml";
}

<script src="~/Scripts/jquery.tmpl.js"></script>
<script>
    function aboutPhoto(obj) {
        //e.preventDefault();

        $(".selectedPhoto").hide().html('');
        $("#indicator").show();

        var url = $(obj).attr('href');

        $.getJSON(url, null, function (photo) {
            $("#indicator").hide();

            $("div #photoTemplate")
                .tmpl(photo)
                .appendTo('.selectedPhoto');

            $('.selectedPhoto').show();
        });
    }
</script>

<div style="width: 80%; margin:0 auto; display:block;">
    <h2>Result of search</h2>
    <hr>
    <div class="rTable" id="searchPhotos">
        @{var counter = 1; }
        <div class="rTableRow">
            @foreach (var photo in Model)
            {
                <div class="rTableCell">
                    <a onclick='aboutPhoto(this)' data-ajax='true' data-ajax-mode='replace' data-ajax-update='#photoTemplate' href='/Photo/Details?photoId=@photo.Id'>
                        <img src='/Photo/GetImage?photoId=@photo.Id' width="100" height="100" />
                    </a>
                </div>
                if (counter % 3 == 0)
                {
                    @:</div><div class="rTableRow">
                }
                counter++;
            }
        </div>
    </div>
    <div style="width: 40%; margin-left: 38em;">
    <span id="searchPhoto"></span>
    <img id="indicator" src="@Url.Content("~/Content/images/ajax-loader.gif")" alt="loading..." style="display:none" />
    <div class="selectedPhoto" style="display:none">
    </div>
    <script id="photoTemplate" type="text/x-jquery-tmpl">
        <p class="photoDescription">
            ${Description}
        </p>
        <img src="/Photo/GetImage?photoId=${Id}" alt="Speaker image" class="speaker-pic" width="300" height="300" />
        <br style="clear:both;" />
    </script>  
    </div>
</div>